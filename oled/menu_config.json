[
  {
    "name": "Status",
    "submenu": [
      { "name": "USB:",         "status_cmd": "{P4WN_HOME}/p4wnctl.py usb status" },
      { "name": "Payload:",     "status_cmd": "{P4WN_HOME}/p4wnctl.py payload status" },
      { "name": "Web UI:",      "status_cmd": "{P4WN_HOME}/p4wnctl.py web status" },
      { "name": "IP:",          "status_cmd": "{P4WN_HOME}/p4wnctl.py ip" },
      { "name": "← Back" }
    ]
  },
  {
    "name": "USB Mode",
    "submenu": [
      { "name": "Active:", "status_cmd": "{P4WN_HOME}/p4wnctl.py usb statusi | head -n1" },
      { "name": "HID + NET",        "action": "{P4WN_HOME}/p4wnctl.py usb set hid_net_only" },
      { "name": "HID + NET + MSD",  "action": "{P4WN_HOME}/p4wnctl.py usb set hid_storage_net" },
      { "name": "Storage Only",     "action": "{P4WN_HOME}/p4wnctl.py usb set storage_only" },
      { "name": "← Back" }
    ]
  },
  {
    "name": "Payloads",
    "submenu": [
      { "name": "Current:", "status_cmd": "{P4WN_HOME}/p4wnctl.py payload status" },
      { "name": "reverse_shell",       "action": "{P4WN_HOME}/p4wnctl.py payload set reverse_shell" },
      { "name": "autorun_powershell",  "action": "{P4WN_HOME}/p4wnctl.py payload set autorun_powershell" },
      { "name": "test_typing",         "action": "{P4WN_HOME}/p4wnctl.py payload set test_typing" },
      { "name": "← Back" }
    ]
  },
  {
    "name": "Web UI",
    "submenu": [
      { "name": "Status:",  "status_cmd": "{P4WN_HOME}/p4wnctl.py web status" },
      { "name": "Show URL", "action": "{P4WN_HOME}/p4wnctl.py web url" },
      { "name": "Bind (Host:Port)",
    	"submenu": [
            { "name": "AUTO (primary):8080", "action": "{P4WN_HOME}/p4wnctl.py web config set --host auto --port 8080" },
            { "name": "0.0.0.0:8080",        "action": "{P4WN_HOME}/p4wnctl.py web config set --host 0.0.0.0 --port 8080" },
            { "name": "0.0.0.0:9090",        "action": "{P4WN_HOME}/p4wnctl.py web config set --host 0.0.0.0 --port 9090" },
            { "name": "127.0.0.1:8000",      "action": "{P4WN_HOME}/p4wnctl.py web config set --host 127.0.0.1 --port 8000" },
            { "name": "127.0.0.1:8080",      "action": "{P4WN_HOME}/p4wnctl.py web config set --host 127.0.0.1 --port 8080" }
          ]
      },
      { "name": "Start",    "action": "{P4WN_HOME}/p4wnctl.py web start" },
      { "name": "Stop",     "action": "{P4WN_HOME}/p4wnctl.py web stop" },
      { "name": "Restart",  "action": "{P4WN_HOME}/p4wnctl.py web restart" },
      { "name": "Enable",   "action": "{P4WN_HOME}/p4wnctl.py web enable" },
      { "name": "Disable",  "action": "{P4WN_HOME}/p4wnctl.py web disable" },
      { "name": "← Back" }
    ]
  },
  {
    "name": "HID Attacks",
    "submenu": [
      { "name": "PSH Reverse InMemory",     "script": "{P4WN_HOME}/payloads/hid/reverse_inmemory.py" },
      { "name": "PSH Reverse HTTP", 	    "script": "{P4WN_HOME}/payloads/hid/reverse_http_fetch.py" },
      { "name": "USB Stealer",              "script": "{P4WN_HOME}/payloads/hid/usb_stealer.py" },
      { "name": "Domain Enumerator",        "script": "{P4WN_HOME}/payloads/hid/domain_enum_hid.py" },
      { "name": "Lockpicker",               "script": "{P4WN_HOME}/payloads/hid/lockpicker.py" },
      { "name": "Test Typing",              "script": "{P4WN_HOME}/payloads/hid/test_typing.py" },
      { "name": "← Back" }
    ]
  },
  {
    "name": "Network Attacks",
    "submenu": [
      { "name": "Rogue DHCP + DNS",         "script": "{P4WN_HOME}/payloads/network/rogue_dhcp_dns.py" },
      { "name": "DNS Spoof & Redirect",     "script": "{P4WN_HOME}/payloads/network/dns_spoof_redirect.py" },
      { "name": "Responder Attack",         "script": "{P4WN_HOME}/payloads/network/responder_attack.py" },
      { "name": "Credential Snarf + Spoof", "script": "{P4WN_HOME}/payloads/network/credsnarf_spoof.py" },
      { "name": "← Back" }
    ]
  },
  {
    "name": "Listeners",
    "submenu": [
      { "name": "HID Backdoor Listener",  "script": "{P4WN_HOME}/payloads/listeners/hid_backdoor.py" },
      { "name": "Reverse Shell: Start 4444", "script": "{P4WN_HOME}/payloads/listeners/reverse_shell_listener.py", "background": true },
      { "name": "Reverse Shell: Stop", "action": "bash -lc \"tmux kill-session -t p4wnp1_rshell || systemctl stop p4wnp1-rshell || pkill -f 'nc -lvnp 4444'\"", "background": true },
      { "name": "← Back" }
    ]
  },
  {
    "name": "Shell Access",
    "submenu": [
      { "name": "Start Serial Shell",              "script": "{P4WN_HOME}/payloads/shell/reverse_to_host.py" },
      { "name": "Stop Serial Shell",               "action": "systemctl stop serial-getty@ttyGS0.service" },
      { "name": "Start Tmux Shell (USB-Ethernet)", "script": "{P4WN_HOME}/payloads/shell/start_tmux_shell.py" },
      { "name": "Stop Tmux Shell",                 "action": "pkill -f 'tmux -S /tmp/p4wnp1_shell'" },
      { "name": "← Back" }
    ]
  },
  {
    "name": "Mass Storage",
    "script": "{P4WN_HOME}/payloads/mass_storage.py"
  },
  {
    "title": "Services",
    "submenu": [
      { "title": "USB: Status",     "action": "{P4WN_HOME}/p4wnctl.py service status p4wnp1.service" },
      { "title": "USB: Restart",    "action": "{P4WN_HOME}/p4wnctl.py service restart p4wnp1.service" },
      { "title": "OLED: Install",   "action": "{P4WN_HOME}/p4wnctl.py service install oledmenu.service" },
      { "title": "OLED: Uninstall", "action": "{P4WN_HOME}/p4wnctl.py service uninstall oledmenu.service" },
      { "title": "OLED: Restart",   "action": "{P4WN_HOME}/p4wnctl.py service restart oledmenu.service" },
      { "title": "Web: Status",     "action": "{P4WN_HOME}/p4wnctl.py service status p4wnp1-webui.service" },
      { "title": "Web: Restart",    "action": "{P4WN_HOME}/p4wnctl.py service restart p4wnp1-webui.service" }
    ]
  },
  {
    "name": "System",
    "submenu": [
      { "name": "Reboot",   "action": "reboot" },
      { "name": "Shutdown", "action": "poweroff" },
      { "name": "← Back" }
    ]
  }
]

